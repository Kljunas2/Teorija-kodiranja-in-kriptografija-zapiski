\input{config.tex}
\begin{document} 

\begin{multicols}{4}
\setlength{\premulticols}{1pt}
\setlength{\postmulticols}{1pt}
\setlength{\multicolsep}{1pt}
\setlength{\columnsep}{2pt}

\section*{Kriptosistem}
\begin{align*}
	\mathcal{B} &\dots \text{besedila} \\
	\mathcal{C} &\dots \text{kriptogrami} \\
	\mathcal{K} &\dots \text{ključi} \\
	\mathcal{E} = \{E_k : \mathcal{B} \to \mathcal{C}; k \in \mathcal{K} \} &\dots \text{kodirne f.} \\
	\mathcal{D} = \{D_k : \mathcal{C} \to \mathcal{B}; k \in \mathcal{K} \} &\dots \text{dekodirne f.} \\
\end{align*}
Za vsak $e \in \mathcal{K}$ obstaja $d \in \mathcal{K}$
\[ D_d(E_e(x)) = x \quad \forall x \in \mathcal{B}\]

Vsaka kodrirna funkcija $E_k \in \mathcal{E}$ je injektivna.

\subsection*{Produkt kriptosistemov}
Naj bosta $\mathcal{S}_1 = (\mathcal{B}_1, \mathcal{C}_1, \mathcal{K}_1, \mathcal{E}', \mathcal{D}')$ in 
$\mathcal{S}_2 = (\mathcal{B}_2, \mathcal{C}_2, \mathcal{K}_2, \mathcal{E}'', \mathcal{D}'')$ kriptosistema za katera
je $\mathcal{C}_1 = \mathcal{B}_2$.

\[ S_1 \times S_2 = (\mathcal{B}_1, \mathcal{C}_2, \mathcal{K}_1 \times \mathcal{K}_2, \mathcal{E}, \mathcal{D})\]
\begin{align*}
	E_{(k_1, k_2)} (x) &= E''_{k_2}(K'_{k_1}(x)) \\
	D_{(k_1, k_2)} (y) &= D'_{k_1}(D''_{k_2}(y))
\end{align*}

\subsection*{Prevedljivost kriptosistemov}
Kripto sistem $\mathcal{S} = (\mathcal{B}, \mathcal{C}, \mathcal{K}, \mathcal{E}, \mathcal{D})$ je prevedljiv na
$\mathcal{S}' = (\mathcal{B}, \mathcal{C}, \mathcal{K}', \mathcal{E}', \mathcal{D}')$, če obstaja $f: \mathcal{K} \to \mathcal{K}'$, 
da za vsak $k \in \mathcal{K}$ velja:
\[ E_k = E'_{f(k)} \qquad D_k = D'_{f(k)} \]
Tedaj pišemo $S \to S'$.

Kriptosistema sta \textbf{ekvivalentna}, če velja $S \to S'$ in $S' \to S$.

Tedaj pišemo $S \equiv S'$.

\subsection*{Idempotentnost kriptosistemov}
Kriptosistem $S$ je idempotenten, če
\[ S \times S \equiv S\]
\textit{Klasični kriposistem so vsi idempotentni.}

\section*{Klasični kriptosistem}
\subsection*{Cezarjeva šifra}
\[ \mathcal{B} = \mathcal{C} = \mathcal{K} = \mathbb{Z}_{25}\]
\[ E_k(x) \equiv x + k \mod 25\]
\[ D_k(y) \equiv y - k \mod 25\]

\subsection*{Substitucijska šifra}
\[ \mathcal{B} = \mathcal{C} = \mathbb{Z}_{25}, \quad \mathcal{K} = S(\mathbb{Z}_{25})\]
Ključ je permutacija $\pi \in \mathcal{K}$
\[ E_k(x) = \pi(x) \]
\[ D_k(y) = \pi^{-1}(y) \]

\subsection*{Afina šifra}
\[ \mathcal{B} = \mathcal{C} = \mathbb{Z}_{25}, \quad \mathcal{K} = \mathbb{Z}_{25}^{*} \times \mathbb{Z}_{25} \]
Ključ $(a, b) \in \mathcal{K}$
\[ K_{(a,b)}(x) = ax + b \mod 25\]
\[ D_{(a,b)}(y) = a^{-1}(y - b) \mod 25\]

\subsection*{Vigenerjeva šifra}
\[ \mathcal{B} = \mathcal{C} = \mathcal{K} = \mathbb{Z}_{25}^n\]
Ključ $\underline{k} \in \mathcal{K}$
\[ K_{\underline{k}}(\underline{x}) = \underline{x} + \underline{k} \mod 25\]
\[ D_{\underline{k}}(\underline{y}) = \underline{y} - \underline{k} \mod 25\]

\subsection*{Permutacijska šifra}
\textit{Simbolov ne nadomeščamo, ampak jih premešamo}
\[ \mathcal{B} = \mathcal{C} = \mathbb{Z}_{25}^n, \quad \mathcal{K} = S_n\]
\[ K_{\pi}(\underline{x}) = \underline{x}_{\pi(1)} + \dots + \underline{x}_{\pi(n)}  \]
\[ D_{\pi}(\underline{x}) = \underline{x}_{\pi^{-1}(1)} + \dots + \underline{x}_{\pi^{-1}(n)}  \]

\subsection*{Hillova šifra}
\[ \mathcal{B} = \mathcal{C} = \mathbb{Z}_{25}^n, \quad \mathcal{K} = \{ A \in \mathbb{Z}_{25}^{n\times n} | \det(A) \in \mathbb{Z}_{25}^* \}\]
Ključ je matrika $A \in \mathcal{K}$
\[ K_A(\underline{x}) = A \underline{x} \mod 25\]
\[ D_A(\underline{y}) = A^{-1} \underline{y} \mod 25\]

\section*{Bločne šifre}
Kripotsistem $(\mathcal{B}, \mathcal{C}, \mathcal{K}, \mathcal{E}, \mathcal{D})$ je bločna šifra dolžine n, 
če je $\mathcal{B} = \mathcal{C} = \Sigma^n$, kjer je $\Sigma$ končna abeceda.

Vsaka kodirna funkcija je ekvivalentna neki permutaciji $\Sigma^n$, njena dekodirna funkcija pa inverzu te permutacije.

\subsection*{Afina bločna šifra}
\[ \Sigma = \mathbb{Z}_m \]
\[ \mathcal{K} = \left\{ (A, \underline{b});\ A \in \mathbb{Z}_m^{n\times n}, \det(A) \in \mathbb{Z}_m^*, \underline{b} \in \mathbb{Z}^n_m \right\}  \]
\begin{align*}
	E_{(A, \underline{b})}(\underline{x}) &\equiv A \underline{x} + \underline{b} \mod m \\
	D_{(A, \underline{b})}(\underline{x}) &\equiv A^{-1} \underline{x} - \underline{b} \mod m 
\end{align*}

\subsection*{Iterativne šifre}
Sestavlja jih 

\begin{itemize}
	\item \textbf{razpored ključev}: Naj bo $K$ ključ. $K$ uporabimo za konstrukcijo krožnih ključev $(K^1,\dots, K^{N_r})$ temu seznamu pravimo razpored ključev.
	\item \textbf{krožna funkcija}: ima dva argumenta: tekoče stanje in krožni ključ:
	\[ w^r = g(w^{r-1}, K^{r}) \]
	Da je dešifriranje možno mora biti $g$ injektivna za vsak fiksen ključ $K$; tj. $\exists g^{-1}:$
	\[ g^{-1}(g(w, K), K) = w \qquad \forall w, K\]
	\item \textbf{šifriranje skozi $N_r$ podobnih krogov}: Besedilo $x$ vzamemo za začetno stanje $w^0$:
	\[ y = g(g(\dots g(g(x, K^1), K^2) \dots, K^{N_r - 1}), K^{N_r})\]
	\item \textbf{dešifriranje}:
	\[ x = g^{-1}(\dots g^{-1}(g^{-1}(y, K^{N_r}), K^{N_r - 1}) \dots, K^1)\]
\end{itemize}


\subsection*{Substitucijsko-permutacijsko omrežje}
je iterativna bločna šifra kjer je $\Sigma = \{0,1\}$, $\ell, m \in \mathbb{N}$ in $\mathcal{B} = \mathcal{C} = \Sigma^{\ell m}$

\begin{itemize}
	\item \textbf{substitucije}: $\pi_s \in S(\Sigma^\ell)$ \\
	\textit{S-škatla} - zamenja $\ell$ bitov z drugimi biti
	\item \textbf{permutacije}: $\pi_p \in S_{\ell m}$ \\
	\textit{P-škatla} - zamenja $\ell m$ bitov z drugimi biti
\end{itemize}

\textit{Oznaka za delitev na zloge dolžine $\ell$:}
\[ x = x_1 x_2 \dots x_m, \quad |x_i| = \ell \]

\textbf{Kodiranje:}
\begin{koda}
$w^0 = b$
za $r = 1, \dots, N_r - 1$ :
	$u^r = w^{r-1} \oplus K^r$ // primasamo K
	za $i = 1, \dots, m$ :
		$\underline{v}_i^r = \pi_s(\underline{u}_i^r)$ // substitucija zlogov
	$w^r = v_{\pi_p(1)}^r, \dots, v_{\pi_p(\ell m)}^r$ // permutacija bitov
// zadnji krog
$u^{N_r} = w^{N_r - 1} \oplus K^{N_r}$
za $ i = 1, \dots, m$ :
	$\underline{v}_i^{N_r} = \pi_s(\underline{u}_i^{N_r})$
vrni $c = v^{N_r} \oplus K^{N_r + 1}$  // beljenje
\end{koda}

\textbf{Dekodiranje}:
\begin{koda}
$v^N_r = c \oplus K^{N_r + 1}$
za $ i = 1, \dots, m$:
	$\underline{u}_i^{N_r} = \pi_s^{-1}(\underline{v}_i^{N_r})$
za $ r = N_r - 1, \dots, 1$:
	$w^r = u^r \oplus K^{r+1}$
	$v^r = (w_{\pi_p^{-1}(1)}^r, \dots, w_{\pi_p^{-1}(\ell m)}^r)$
	za $ i = 1, \dots, m$:
		$\underline{u}^r_i = \pi_s^{-1}(\underline{v}_i^r)$
$b = u^1 \oplus K^1$
\end{koda}

\subsection*{Feistelova šifra}
je bločna iterativna šifra dolžine $2t$ za abecedo $\Sigma = \{0, 1\}$.

$N_r$ je št. krogov, $K^1, \dots, K^{N_r}$ razpored ključev, ki ga dobimo iz ključa
$K$ in $f_K: \Sigma^t \to \Sigma^t$ je \textit{Feistelova kodirna funkcija}.

\textit{En krog kodiranja:}
\begin{center}
	\resizebox*{0.5\columnwidth}{!}{\includegraphics{img/feistel.png}}
\end{center}

\textit{Kodiranje}
\begin{koda}
$L_0 = $ leva polovica $b$
$R_0 = $ desna polovica $b$
za $i = 1, \dots, N_r$:
	$L_i = R_{i-1}$
	$R_i = L_{i-1} \oplus f_{K_i}(R_{i-1})$
$c = R_{N_r} \| L_{N_r}$
\end{koda}

\subsection*{DES in AES}
TO-DO!

\section*{Tokovne šifre}
Besedilo $b$ razdelimo na bloke $b = b_1 \dots b_t \in \mathcal{B}^t$.

Imamo zaporedje (tok) ključev: $z_1, z_2, \dots \in \mathcal{K}$.

\textit{Kodiranje}
\begin{koda}
za $j = 1, \dots, t$:
	$c_j = E_{z_j}(b_j)$
$c = c_1 c_2 \dots c_t \in \mathcal{C}^t$
\end{koda}

\textit{Dekodiranje}
\begin{koda}
za $j = 1, \dots, t$:
	$b_j = D_{z_j}(c_j)$
$b = b_1 b_2 \dots c_t \in \mathcal{B}^t$
\end{koda}

\subsection*{Aditivne tokovne šifre}
Naj bo $(G, +)$ grupa, $\mathcal{B} = \mathcal{C} = \mathcal{K}$ in $z_1, z_2, \dots$ tok ključev.

\textit{Kodiranje}
\begin{align*}
E_{z_i} (b_i) &= b_i + z_i \\	
D_{z_i} (c_i) &= c_i - z_i \\	
\end{align*}

\subsection*{Samokodirna šifra}
$\mathcal{B} = \mathcal{C} = \mathcal{K} = \mathbb{Z}_{26}$

Začetni ključ izberemo $z_1 \in \mathbb{Z}_{26}$
\[ z_i = b_{i-1} \quad \text{za }\ i > 1 \]

\textit{Kodiranje}
\[ E_{Z_i}(b_i) = b_i + z_i \]

\textit{Dekodiranje}
\[ D_{Z_i}(c_i) = c_i - z_i \]

\subsection*{Vermanova šifra}
$\mathcal{B} = \mathcal{C} = \mathcal{K} = \{0, 1\}^n$, ključ izberemo naključno.

\textit{Kodiranje}
\[ E_k(b) = b \oplus k \]
\textit{Dekodiranje}
\[ D_k(c) = c \oplus k \]

\textit{To je pravzaprav Vigenerjeva šifra, le da ima ključ enako dolžino kot besedilo}

\textit{Uporabimo kratko seme za generiranje dolgega toka psevdonaključnih bitov, ki jih uporabimo za ključ.}

\subsection*{Linearna rekurzivna šifra}
je sinhrona tokovna šifra, pri kateri je
\[ \mathcal{B} = \mathcal{C} = \mathcal{K} = \mathbb{Z}_s\]
zaporedje ključev z linearno rekurzinvo enačbo reda $m$ s konstantnimi koeficienti nad $\mathbb{Z}_s$:
\[ z_i = c_1 z_{i-1} + c_2 z_{i-2} + \dots + c_m z_{i_m} \mod s \]
Zaporedju lahko priredimo polinom:
\[ C(x) = 1 + \sum_{i=1}^m c_i x^i \mod s\]

\textit{Kodiranje/Dekodiranje:}
\begin{align*}
	E_{z_i}(x_i) &= x_i + z_i \mod s \\
	D_{z_i}(y_i) &= y_i - z_i \mod s
\end{align*}

\subsection*{Pomični register z linearno povratno zanko}
V pomičnem registru je na začetku inicializacijski vektor $(z_1 z_2 \dots z_m)$ (ključ).

Na vsakem koraku izpišemo $z_1$ register pomaknemo v levo zadnji bit $z_m$ pa 
izračunamo kot z $c_1, \dots, c_m$ uteženo vsoto.

\begin{center}
	\resizebox*{0.9\columnwidth}{!}{\includegraphics{img/lfsr.png}}
\end{center}

\section*{Teorija števil}

\subsection{Eulerjeva funkcija}
Eulerjeva funkcija nam pove koliko je obrnlivih elementov v $\mathbb{Z}_m$.

\[ | \mathbb{Z}_m^* | = \varphi(m) \]

Za $n \in \mathbb{N}$ s paraštevilskim razcepom \\ $ n = p_1^{\alpha_1} \cdot ... \cdot p_m^{\alpha_m}$ velja:
\[\varphi(n) = \varphi(p_1^{\alpha_1}) \cdot ... \cdot \varphi(p_m^{\alpha_m}) = n \prod_{ p_k \in \mathbb{P}} \left(1-\frac{1}{p_k} \right) \]

\textbf{Euljerjev izrek:}

Naj bo $G$ končna grupa. Potem red elementa $a \in G$ deli red grupe $G$.

\[\textrm{gcd}(a, m) = 1 \Leftrightarrow a^{\varphi(m)} \equiv_m 1; a \in \mathbb{Z}_m^*\]
\[a,m \in \mathbb{N} \wedge \textrm{gcd}(a, m) = 1 \Rightarrow a^{\varphi(m)} \equiv_m 1\]
\[a^{\varphi(m)} = 1 \text{ v } \mathbb{Z}_m^*\]

\textbf{Mali Fermatov izrek:} če je $m \in \mathbb{P}$ ($\varphi(m) = m-1$) in $\textrm{gcd}(a,m) = 1$, potem:
\[a^{m-1} \equiv_m 1\]

\subsubsection*{Razširjen evklidov algoritem}

\begin{koda}
vhod: $(a, b)$
($r_0$, $x_0$, $y_0$) = ($a$, 1, 0)
($r_1$, $x_1$, $y_1$) = ($b$, 0, 1)
$i$ = 1

dokler $r_i$ $\neq$ 0:
    $i$ = $i$+1
    $k_i$ = $r_{i-2} // r_{i-1}$
    $(r_i, x_i, y_i)$ = $(r_{i-2}, x_{i-2}, y_{i-2}) - k_i(r_{i-1}, x_{i-1}, y_{i-1})$
konec zanke
vrni: $(r_{i-1}, x_{i-1}, y_{i-1})$
\end{koda}

Naj bosta $a, b \in \mathbb{Z}$. Tedaj trojica $(d, x, y)$, ki jo vrne razširjen evklidov algoritem z vhodnim podatkomk $(a, b)$, zadošča:
\[ax + by = d \text{ in } d = \textrm{gcd}(a, b)\] 


\subsection*{Grupe}
\begin{itemize}
    \item \textbf{grupoid} $(M, \cdot)$ urejen par z neprazno množico $M$ in zaprto opreacijo $\cdot$.
    \item \textbf{polgrupa} grupoid z asociativno operacijo $ \forall x,y,z \in M : (x\cdot y)\cdot z = x\cdot (y\cdot z)$.
    \item \textbf{monoid} polgrupa z enoto $ \exists e \in M \ \forall x \in M : e\cdot x = x\cdot e = x$.
    \item \textbf{grupa} polgrupa v kateri ima vsak element inverz $ \forall x \in M \ \exists x^{-1} \in M : x\cdot x^{-1} = x^{-1}\cdot x = e$.
    \item \textbf{abelova grupa} grupa s komutativno operacijo $ \forall x,y \in M  : x\cdot y = y\cdot x$.
\end{itemize} 

\subsubsection{Množica $\mathbb{Z}_m$}
$\mathbb{Z}_m = \{0,1,...,m-1\}$

Vpeljemo seštevanje $+_m$ po modulu $m$ in množenje $\cdot_m$ po modulu $m$. 
Dobimo grupo $(\mathbb{Z}_m, +_m)$ in monoid $(\mathbb{Z}_m, \cdot_m)$.

Red elementa $x\in \mathbb{Z}_m$ je $\frac{m}{\gcd(m,x)}$

\subsubsection{Množica $\mathbb{Z}_m^*$}
To je množica vseh obrnljivih elementov v $\mathbb{Z}_m$ (operacija: množenje).
\[|\mathbb{Z}^*_m| = \varphi(m)\]
Element $x\in \mathbb{Z}_m$ je obrnljiv če se da rešiti \emph{diofantsko enačbo}:
\[ xy + km = 1\]
za neznanki $y$ (inverz od $x$) in $k$.

\subsubsection{Cayleyjeva tabela}
Za vsak element množice imamo en stolpec in eno vrstico. V vsakem polju je produkt elementa vrstice in elementa stolpca.
(Presek vrstice $a$ in stolpca $b$ je $ab$)

\subsubsection{Red elementa}
Naj bo $(G,\cdot)$ grupa. Red elemneta $a$ je najmanjše naravno število $n \in \mathbb{N}$, da velja
\[a^n = e\]
\textit{oznaka:} $\#a$

\subsubsection{Red grupe}
je število elementov $G$, oznaka $|G|$.

\subsubsection*{Ciklična grupa}
Grupa je ciklična, če vsebuje $a$ reda $|G|$:
\[ G = \left\{ a, a^2, a^3, \dots, a^{|G|} = e\right\}\]

\subsection*{Končni obsegi}
$(K, +,\cdot)$ je obseg, če je
\begin{itemize}
	\item $(K, +)$ abelova grupa
	\item $(K^*, \cdot)$ grupa ($K^* = K \setminus \{0\}$)
	\item velja distributivnost:
	\[ a \cdot (b+c) = (a\cdot b) + (a \cdot c)\]
	\[ (a+b) \cdot c = (a\cdot c) + (b \cdot c)\]
\end{itemize}

Obseg je \textbf{komutativen}, če je $(K^*, \cdot)$ komutativna.

\subsection*{Praštevilski obsegi}
Če je $p$ praštevilo, je $(\mathbb{Z}_p, +_p, \cdot_p)$ končen obseg.


\subsection*{Galoisovi obsegi}
\[\text{GF}(p) \cong \mathbb{Z}_p \qquad p \in \mathbb{P}\]
\[ \text{GF}(p^n) \cong \mathbb{Z}_p[x]/(u) \]
\begin{itemize}
	\item $u \in \mathbb{Z}_p[x]$ je nerazcepen polinom stopnje $n$
	\item elementi $\text{GF}(p^n)$ so ostanki polinomov iz $\mathbb{Z}_p$ pri deljenju z polinomom $u$
	\item seštevanje je enako kot seštevanje v $\mathbb{Z}_p[x]$
	\item produkt izračunamo v $\mathbb{Z}_p[x]$ nato pa vzamemo ostanek pri deljenju z $u$
\end{itemize}

Množica neničelnih/obrnljivih elementov $(GF(p^n)^*, \cdot) \cong (\mathbb{Z}_{p^n-1}, \cdot)$ je vedno izomorfna neki ciklični grupi.
Generatorjem te grupe rečemo \textbf{primitivni elementi} Galoisovega obsega.

\end{multicols}
\end{document}